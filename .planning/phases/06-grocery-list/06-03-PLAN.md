---
phase: 06-grocery-list
plan: 03
type: execute
wave: 3
depends_on: ["06-02"]
files_modified:
  - src/App.tsx
  - src/index.css
  - src/hooks/useMobileNav.ts
  - src/components/layout/MobileNav.tsx
autonomous: true
requirements: [GROC-01, GROC-02, GROC-03, GROC-04]

must_haves:
  truths:
    - "Wall display shows grocery card in sidebar when unchecked items exist"
    - "Wall display hides grocery card when no unchecked items exist"
    - "Mobile user can navigate between Calendar and Groceries views"
    - "Mobile grocery view is full-height with sticky input at bottom"
    - "Grocery changes made on mobile appear on wall display in real-time"
    - "App builds and renders correctly with no Supabase configured (graceful degradation)"
  artifacts:
    - path: "src/App.tsx"
      provides: "Integrated grocery panel in both wall and mobile layouts"
      contains: "GroceryPanel"
    - path: "src/hooks/useMobileNav.ts"
      provides: "Simple mobile navigation state hook"
      exports: ["useMobileNav"]
    - path: "src/components/layout/MobileNav.tsx"
      provides: "Bottom tab bar for mobile navigation"
      exports: ["MobileNav"]
    - path: "src/index.css"
      provides: "Updated mobile layout with nav area and conditional main content"
      contains: "grid-area-nav"
  key_links:
    - from: "src/App.tsx"
      to: "src/components/grocery/GroceryPanel.tsx"
      via: "renders compact in sidebar, full in mobile main"
      pattern: "GroceryPanel.*variant"
    - from: "src/App.tsx"
      to: "src/hooks/useGroceries.ts"
      via: "reads uncheckedCount for conditional sidebar rendering"
      pattern: "useGroceries.*uncheckedCount"
    - from: "src/App.tsx"
      to: "src/components/layout/MobileNav.tsx"
      via: "renders bottom nav on mobile"
      pattern: "<MobileNav"
---

<objective>
Wire the grocery list into the dashboard: wall display sidebar (compact, conditional) and mobile layout (full, with bottom tab navigation).

Purpose: Makes grocery list accessible to users on both wall display and mobile phones, completing the Phase 6 feature.
Output: Updated `App.tsx`, new mobile nav components, updated CSS grid for mobile nav area
</objective>

<execution_context>
@/Users/joshua/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joshua/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-grocery-list/06-RESEARCH.md
@.planning/phases/06-grocery-list/06-01-SUMMARY.md
@.planning/phases/06-grocery-list/06-02-SUMMARY.md
@src/App.tsx
@src/index.css
@src/components/layout/DashboardShell.tsx
@src/components/grocery/GroceryPanel.tsx
@src/hooks/useGroceries.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create mobile navigation hook and component</name>
  <files>src/hooks/useMobileNav.ts, src/components/layout/MobileNav.tsx</files>
  <action>
**useMobileNav.ts:**
Simple state hook for mobile view switching. This scales to Phase 7 (Timers) and Phase 9 (Chores).

```typescript
export type MobileView = 'calendar' | 'groceries';

export function useMobileNav() {
  const [activeView, setActiveView] = useState<MobileView>('calendar');
  return { activeView, setActiveView };
}
```

Import `useState` from React.

**MobileNav.tsx:**
Bottom tab bar component, only rendered on mobile. Accepts `{ activeView: MobileView; onNavigate: (view: MobileView) => void }`.

- Outer container: `grid-area-nav` CSS class (will be added to index.css), flex row with equal-width items
- Styling: `flex bg-bg-primary/80 backdrop-blur-sm border-t border-white/10`
- Two tab buttons, each taking `flex-1`:
  1. Calendar tab: `IoCalendarOutline` icon from react-icons/io5 (w-6 h-6), label "Calendar" below
  2. Groceries tab: `IoCartOutline` icon from react-icons/io5 (w-6 h-6), label "Groceries" below
- Each button: `flex flex-col items-center justify-center py-2 min-h-[56px]` (comfortable mobile tap)
- Active tab: `text-accent-gold`, inactive: `text-white/40`
- Label: `text-xs mt-1`
- Tab buttons call `onNavigate(view)` on click

Hidden on landscape/desktop (handled by CSS grid -- the `grid-area-nav` area doesn't exist in desktop layout).
  </action>
  <verify>Run `npx tsc --noEmit` -- no type errors.</verify>
  <done>Mobile navigation hook and tab bar component ready. Two tabs: Calendar and Groceries. Scales to more tabs in future phases.</done>
</task>

<task type="auto">
  <name>Task 2: Update CSS grid and wire everything into App.tsx</name>
  <files>src/index.css, src/App.tsx</files>
  <action>
**index.css changes:**

Update the portrait/mobile media query to include a nav row at the bottom:

```css
@media (max-width: 768px) and (orientation: portrait) {
  .dashboard-grid {
    grid-template-areas:
      'header'
      'main'
      'status'
      'nav';
    grid-template-columns: 1fr;
    grid-template-rows: auto 1fr auto auto;
  }

  .grid-area-sidebar {
    display: none;
  }
}
```

Add the nav grid area assignment:
```css
.grid-area-nav {
  grid-area: nav;
}
```

The nav area only exists in the mobile grid template, so MobileNav is naturally hidden on desktop/kiosk without needing a display:none.

**App.tsx changes:**

Add imports:
- `GroceryPanel` from `./components/grocery/GroceryPanel`
- `useGroceries` from `./hooks/useGroceries`
- `useMobileNav` from `./hooks/useMobileNav`
- `MobileNav` from `./components/layout/MobileNav`

In the App function body:
1. Call `const { uncheckedCount } = useGroceries();` -- used for conditional sidebar rendering
2. Call `const { activeView, setActiveView } = useMobileNav();`

**Wall display sidebar (landscape):**
In the sidebar div (`.grid-area-sidebar`), add the compact grocery card ABOVE the ContentRotator, conditionally rendered:
```tsx
{uncheckedCount > 0 && <GroceryPanel variant="compact" />}
```

**Mobile main area (portrait):**
Update the main content div to conditionally render based on `activeView`:
```tsx
<div className="grid-area-main flex flex-col gap-[clamp(10px,1vw,20px)]">
  {activeView === 'calendar' && <CalendarPanel />}
  {activeView === 'groceries' && <GroceryPanel variant="full" />}
</div>
```

Note: On desktop/landscape, `activeView` doesn't matter because sidebar handles the compact grocery view and main always shows CalendarPanel. The conditional rendering only takes effect on mobile where the sidebar is hidden. To handle this properly, always render CalendarPanel on desktop. Use a simple approach: render CalendarPanel when activeView is 'calendar' OR when the sidebar is visible (desktop). Since CSS handles sidebar visibility, the simplest approach is to always render both but use CSS to control which shows on desktop vs mobile:

Actually, the cleanest approach: On desktop, `activeView` defaults to 'calendar' so CalendarPanel always shows. The sidebar handles grocery display. On mobile, user switches between views via MobileNav. This works without any CSS tricks because:
- Desktop user never calls `setActiveView` (MobileNav is hidden)
- Mobile user taps tabs to switch

So the conditional rendering above is correct as-is.

**MobileNav placement:**
Add `<MobileNav activeView={activeView} onNavigate={setActiveView} />` as the last child inside DashboardShell, after StatusBar. It will only be visible on mobile because its grid area (`nav`) only exists in the mobile grid template.

Final App.tsx structure inside DashboardShell:
1. `<Header />`
2. Main div with conditional CalendarPanel / GroceryPanel based on activeView
3. Sidebar div with conditional compact GroceryPanel + ContentRotator + RotationIndicator
4. `<StatusBar />`
5. `<MobileNav activeView={activeView} onNavigate={setActiveView} />`
  </action>
  <verify>
Run `npm run build` -- builds successfully with zero errors. Verify the build output includes the grocery components by checking the build doesn't tree-shake them away: the imports in App.tsx ensure they're included.
  </verify>
  <done>
Wall display: grocery card appears in sidebar above content rotator when unchecked items exist, hidden otherwise.
Mobile: bottom tab bar switches between Calendar and Groceries views. Grocery view is full-height with sticky input.
App builds and runs correctly with no Supabase configured (graceful degradation -- grocery panel shows "Connect Supabase" message on mobile, hidden on wall display).
  </done>
</task>

</tasks>

<verification>
- `npm run build` succeeds with zero errors
- App.tsx imports and renders GroceryPanel in both sidebar (compact) and main (full) positions
- Mobile CSS grid includes nav row for bottom tab bar
- MobileNav renders with Calendar and Groceries tabs
- Sidebar grocery card is conditionally rendered on `uncheckedCount > 0`
- No new dependencies added
</verification>

<success_criteria>
Grocery list is fully wired into the dashboard. Wall display shows grocery items in sidebar when they exist. Mobile users navigate via bottom tab bar to a full grocery management view. Real-time sync works across all devices via the useGroceries hook from Plan 01. All six Phase 6 success criteria from the roadmap are satisfied by the combined work of Plans 01-03.
</success_criteria>

<output>
After completion, create `.planning/phases/06-grocery-list/06-03-SUMMARY.md`
</output>
