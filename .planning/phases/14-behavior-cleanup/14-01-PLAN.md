---
phase: 14-behavior-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/hooks/usePriorityInterrupt.ts
  - src/hooks/useMobileNav.ts
  - src/components/layout/MobileNav.tsx
  - src/App.tsx
autonomous: true
requirements:
  - BEHV-01
  - BEHV-02

must_haves:
  truths:
    - "Grocery list items do not trigger priority interrupt on the wall display"
    - "Only active timers trigger priority mode in the sidebar"
    - "Timer tab is not present in mobile navigation bar"
    - "Mobile navigation shows 3 tabs (calendar, groceries, chores) with no dead states"
    - "Timers still appear as priority interrupt on wall display when active"
    - "Content rotation resumes when no timers are active"
  artifacts:
    - path: "src/hooks/usePriorityInterrupt.ts"
      provides: "Timer-only priority interrupt logic"
      contains: "hasActiveTimers"
    - path: "src/hooks/useMobileNav.ts"
      provides: "MobileView type without timers"
      contains: "calendar.*groceries.*chores"
    - path: "src/components/layout/MobileNav.tsx"
      provides: "3-tab mobile navigation"
    - path: "src/App.tsx"
      provides: "Clean rendering without timer view branch or grocery priority"
  key_links:
    - from: "src/App.tsx"
      to: "src/hooks/usePriorityInterrupt.ts"
      via: "usePriorityInterrupt(activeTimerCount, completedTimers.length)"
      pattern: "usePriorityInterrupt\\(activeTimerCount.*completedTimers"
    - from: "src/App.tsx"
      to: "src/hooks/useMobileNav.ts"
      via: "activeView type no longer includes timers"
      pattern: "activeView === 'calendar'"
---

<objective>
Remove grocery list from priority interrupt logic and remove timer tab from mobile navigation.

Purpose: Groceries are persistent and permanently block sidebar rotation -- they should be phone-only. Timer tab is unnecessary since timers will be Siri-controlled (Phase 15) and display as wall priority interrupts.
Output: Cleaner sidebar behavior (only timers interrupt) and streamlined 3-tab mobile nav.
</objective>

<execution_context>
@/Users/joshua/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joshua/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-behavior-cleanup/14-RESEARCH.md
@src/hooks/usePriorityInterrupt.ts
@src/hooks/useMobileNav.ts
@src/components/layout/MobileNav.tsx
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove grocery from priority interrupt (BEHV-01)</name>
  <files>src/hooks/usePriorityInterrupt.ts, src/App.tsx</files>
  <action>
Modify `src/hooks/usePriorityInterrupt.ts`:
1. Remove the `uncheckedGroceryCount` parameter from `usePriorityInterrupt` function signature (third param)
2. Remove `const hasGroceries = uncheckedGroceryCount > 0;` line
3. Change `const hasPriority = hasActiveTimers || hasGroceries;` to `const hasPriority = hasActiveTimers;`
4. Remove `showGroceries` from `PriorityState` interface
5. Remove `showGroceries: hasGroceries,` from the return object
6. Update the JSDoc comment to say "Derives sidebar display mode from timer state. When timers are active, the sidebar switches to priority mode instantly."

Modify `src/App.tsx`:
1. Remove `const { uncheckedCount } = useGroceries();` on line 27
2. Remove `import { useGroceries } from './hooks/useGroceries';` on line 20
3. Change line 29 from `usePriorityInterrupt(activeTimerCount, completedTimers.length, uncheckedCount)` to `usePriorityInterrupt(activeTimerCount, completedTimers.length)`
4. In the sidebar priority section (line 70), remove `{priority.showGroceries && <GroceryPanel variant="compact" />}`
5. Since GroceryPanel is still used on line 49 (`activeView === 'groceries'`), keep the GroceryPanel import

Note: The `useGroceries` import is ONLY used for `uncheckedCount` passed to `usePriorityInterrupt`. The `GroceryPanel` component calls `useGroceries` internally. So removing the App-level import is safe.
  </action>
  <verify>Run `npx tsc --noEmit` -- no TypeScript errors. Confirm `usePriorityInterrupt` accepts exactly 2 params. Confirm no references to `showGroceries` or `uncheckedCount` remain in App.tsx. Confirm `useGroceries` import is removed from App.tsx.</verify>
  <done>Priority interrupt only triggers for active timers. Grocery list no longer appears in wall sidebar. No TypeScript errors.</done>
</task>

<task type="auto">
  <name>Task 2: Remove timer tab from mobile navigation (BEHV-02)</name>
  <files>src/hooks/useMobileNav.ts, src/components/layout/MobileNav.tsx, src/App.tsx</files>
  <action>
Modify `src/hooks/useMobileNav.ts`:
1. Change `MobileView` type from `'calendar' | 'groceries' | 'timers' | 'chores'` to `'calendar' | 'groceries' | 'chores'`

Modify `src/components/layout/MobileNav.tsx`:
1. Remove `IoTimerOutline` from the react-icons import (keep IoCalendarOutline, IoCartOutline, IoCheckmarkDoneCircleOutline)
2. Remove the timer entry from the `tabs` array: `{ view: 'timers', label: 'Timers', icon: IoTimerOutline }`
3. Result: 3 tabs (calendar, groceries, chores). Existing `flex-1` ensures equal distribution.

Modify `src/App.tsx`:
1. Remove the `activeView === 'timers'` rendering branch (lines 52-56):
   ```
   {activeView === 'timers' && (
     <ErrorBoundary FallbackComponent={PanelFallback} onError={logError}>
       <TimerPanel variant="full" />
     </ErrorBoundary>
   )}
   ```
2. Check if `TimerPanel` import is still needed -- YES, it is still used in the sidebar priority section (`priority.showTimers && <TimerPanel variant="compact" />`). Keep the import.
  </action>
  <verify>Run `npx tsc --noEmit` -- no TypeScript errors. Confirm `MobileView` type has exactly 3 members. Confirm no `'timers'` string literal remains in useMobileNav.ts or MobileNav.tsx. Confirm no `activeView === 'timers'` branch in App.tsx. Run `npm run build` to confirm clean production build.</verify>
  <done>Mobile navigation shows 3 tabs (calendar, groceries, chores). No dead timer view state possible. TimerPanel still renders in sidebar priority mode. Clean build with no errors.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npm run build` produces clean production build
3. In App.tsx: `usePriorityInterrupt` called with exactly 2 arguments (no grocery count)
4. In App.tsx: No `activeView === 'timers'` branch exists
5. In App.tsx: No `priority.showGroceries` reference exists
6. In App.tsx: No `useGroceries` import exists
7. In usePriorityInterrupt.ts: Function signature has 2 params (activeTimerCount, completedTimersCount)
8. In useMobileNav.ts: MobileView type is `'calendar' | 'groceries' | 'chores'`
9. In MobileNav.tsx: tabs array has exactly 3 entries, no IoTimerOutline import
</verification>

<success_criteria>
- TypeScript compiles with zero errors
- Production build succeeds
- Priority interrupt only activates for active/completed timers
- Mobile nav renders exactly 3 tabs with equal width
- No dead code references to removed features
</success_criteria>

<output>
After completion, create `.planning/phases/14-behavior-cleanup/14-01-SUMMARY.md`
</output>
