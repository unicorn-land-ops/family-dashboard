---
phase: 09-chore-tracking
plan: 02
type: execute
wave: 2
depends_on:
  - "09-01"
files_modified:
  - src/components/chore/ChorePanel.tsx
  - src/components/chore/ChoreList.tsx
  - src/components/chore/ChoreItem.tsx
  - src/components/chore/ChoreInput.tsx
autonomous: true
requirements:
  - CHOR-01
  - CHOR-02
  - CHOR-03
  - CHOR-04

must_haves:
  truths:
    - "Mobile view shows chores grouped by family member with completion toggles"
    - "User can add a new chore with title, assignee, and schedule from mobile"
    - "Tapping a chore toggles its completion state with person picker"
    - "Wall sidebar compact card shows progress bar and remaining chores"
    - "Completed chores show who completed them and are visually distinct"
  artifacts:
    - path: "src/components/chore/ChorePanel.tsx"
      provides: "Full and compact panel variants"
      contains: "variant.*full.*compact"
    - path: "src/components/chore/ChoreList.tsx"
      provides: "Grouped chore list by assignee"
      contains: "groupByAssignee"
    - path: "src/components/chore/ChoreItem.tsx"
      provides: "Single chore row with completion toggle"
      contains: "isChoreCompleted"
    - path: "src/components/chore/ChoreInput.tsx"
      provides: "Add chore form with assignee picker and schedule selector"
      contains: "addChore"
  key_links:
    - from: "src/components/chore/ChorePanel.tsx"
      to: "src/hooks/useChores.ts"
      via: "hook consumption"
      pattern: "useChores"
    - from: "src/components/chore/ChoreItem.tsx"
      to: "src/lib/choreSchedule.ts"
      via: "completion status check"
      pattern: "isChoreCompleted|getCompletionInfo"
    - from: "src/components/chore/ChoreList.tsx"
      to: "src/lib/choreSchedule.ts"
      via: "grouping by assignee"
      pattern: "groupByAssignee"
---

<objective>
Build the chore UI components: ChorePanel (full/compact), ChoreList, ChoreItem, and ChoreInput.

Purpose: Provides the visual interface for viewing chore progress (wall display) and managing chores (mobile). Follows the same component structure as grocery and timer panels.

Output: Four React components in `src/components/chore/` ready to wire into App.tsx.
</objective>

<execution_context>
@/Users/joshua/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joshua/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-chore-tracking/09-RESEARCH.md
@.planning/phases/09-chore-tracking/09-01-SUMMARY.md

@src/components/grocery/GroceryPanel.tsx
@src/components/grocery/GroceryList.tsx
@src/components/grocery/GroceryItem.tsx
@src/components/grocery/GroceryInput.tsx
@src/components/timer/TimerPanel.tsx
@src/hooks/useChores.ts
@src/lib/choreSchedule.ts
@src/lib/calendar/config.ts
@src/index.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: ChoreItem and ChoreList components</name>
  <files>src/components/chore/ChoreItem.tsx, src/components/chore/ChoreList.tsx</files>
  <action>
Create `src/components/chore/ChoreItem.tsx`:

Props: `{ chore: Chore, completions: ChoreCompletion[], onComplete: (choreId: string, completedBy: string) => void, onUncomplete: (completionId: string) => void, onDeactivate: (id: string) => void }`

Behavior:
- Use `isChoreCompleted(chore, completions)` to determine checked state.
- Use `getCompletionInfo(chore, completions)` to get who completed it.
- When uncompleted: show chore title, assignee emoji badge (look up from CALENDAR_FEEDS by id match to `chore.assigned_to`), and schedule badge ("daily"/"weekly"/"once") in muted text.
- When tapped (uncompleted): show a quick person-picker inline -- 4 buttons with family member emojis (Papa, Daddy, Wren, Ellis) from CALENDAR_FEEDS (filter out 'family'). On pick, call `onComplete(chore.id, selectedPersonId)`. Store last-picked person in localStorage key `'chore-default-person'` for convenience.
- When tapped (completed): call `onUncomplete(completionInfo.id)` to undo.
- Completed state: line-through title, muted opacity, show "Done by [emoji] [name]" text.
- Long-press or swipe-left to reveal delete (deactivate) button -- OR simpler: small X button visible on each item in full variant only.
- Use `card-glass` or similar styling consistent with GroceryItem.

**Simpler approach for person picker:** Instead of inline expanding picker, use localStorage default. If no default set, show the 4-button picker. If default exists, complete immediately with that person. Add a small "switch person" link near the completion area. This reduces tap count for the common case.

Create `src/components/chore/ChoreList.tsx`:

Props: `{ chores: Chore[], completions: ChoreCompletion[], onComplete, onUncomplete, onDeactivate, showCompleted?: boolean }`

Behavior:
- Use `groupByAssignee(chores)` to group chores.
- For each group, render a section header with the person's emoji and name (look up from CALENDAR_FEEDS). For 'unassigned', show "Household" as the header.
- Render ChoreItem for each chore in the group.
- If `showCompleted` is false (compact mode), filter out completed chores from each group. Hide empty groups.
- Sort groups: kids first (wren, ellis), then adults (papa, daddy), then unassigned. This puts routines at the top.
  </action>
  <verify>Run `npx tsc --noEmit` — both files compile with no type errors.</verify>
  <done>ChoreItem renders with completion toggle, person picker, and completion info. ChoreList groups by assignee with section headers. Both compile.</done>
</task>

<task type="auto">
  <name>Task 2: ChoreInput and ChorePanel components</name>
  <files>src/components/chore/ChoreInput.tsx, src/components/chore/ChorePanel.tsx</files>
  <action>
Create `src/components/chore/ChoreInput.tsx`:

Props: `{ onAdd: (title: string, assignedTo: string | null, schedule: 'daily' | 'weekly' | 'once') => void }`

Behavior:
- Text input for chore title (placeholder: "Add a chore...").
- Row of person-picker buttons below input: Papa, Daddy, Wren, Ellis, "Anyone" (null). Use emojis from CALENDAR_FEEDS. Default to null (anyone).
- Schedule toggle: three small buttons for "Daily", "Weekly", "Once". Default to "daily".
- Submit on Enter key or tap submit button. Clear input after submit. Don't submit if title is empty.
- Style consistent with GroceryInput: sticky bottom, backdrop blur, border-top.
- Person and schedule selectors use pill-style buttons with accent-gold highlight when selected.

Create `src/components/chore/ChorePanel.tsx`:

Props: `{ variant?: 'full' | 'compact' }`

**Compact variant** (wall sidebar):
- `card-glass p-4` container matching GroceryPanel compact.
- Header: "Chores" with progress count (e.g., "5/8").
- Progress bar: a thin horizontal bar showing `completedCount / totalCount` filled with accent-gold.
- Below progress: list of REMAINING (uncompleted) chores only, using ChoreList with `showCompleted={false}`.
- Max height 300px with overflow scroll (scrollbar-hide).
- If all chores done: show a checkmark and "All done!" message.

**Full variant** (mobile):
- Same structure as GroceryPanel full variant.
- Header: "Chores" with progress fraction, no "Clear done" button (completions are history).
- ChoreList showing all chores (completed and uncompleted) with `showCompleted={true}`.
- ChoreInput sticky at bottom.
- Show supabase-not-configured message if `!supabaseEnabled`.

Import `useChores` hook. Destructure chores, completions, completedCount, totalCount, addChore, completeChore, uncompleteChore, deactivateChore.
  </action>
  <verify>Run `npx tsc --noEmit` — both files compile. Run `npm run build` — full build succeeds.</verify>
  <done>ChoreInput provides add-chore form with person and schedule pickers. ChorePanel renders full (mobile) and compact (wall) variants with progress tracking. Build passes.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- `npm run build` succeeds
- All four component files exist in `src/components/chore/`
- ChorePanel accepts `variant` prop with full/compact behavior
- ChoreList groups by assignee using choreSchedule functions
- ChoreItem shows completion status with person attribution
- ChoreInput has title, assignee, and schedule inputs
</verification>

<success_criteria>
Four chore UI components built matching the visual patterns of grocery/timer panels. Compact variant shows progress bar and remaining items. Full variant shows grouped chore list with completion toggles and add form. Build passes.
</success_criteria>

<output>
After completion, create `.planning/phases/09-chore-tracking/09-02-SUMMARY.md`
</output>
