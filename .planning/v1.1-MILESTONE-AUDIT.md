---
milestone: v1.1
audited: 2026-02-18
status: gaps_found
scores:
  requirements: 9/10
  phases: 5/5
  integration: 9/10
  flows: 9/10
gaps:
  requirements:
    - id: "SIRI-02"
      status: "unsatisfied"
      phase: "Phase 15"
      claimed_by_plans: ["15-01-PLAN.md"]
      completed_by_plans: ["15-01-SUMMARY.md"]
      verification_status: "missing"
      evidence: "Timer shortcut inserts duration_seconds=0 as sentinel; dashboard has no label-parsing logic to extract duration from text like 'pasta 10 minutes'. Timer appears as immediately-completed 'Done!' alert, not a running countdown. Phase 15 SUMMARY acknowledges this gap explicitly."
  integration:
    - from: "Phase 15 (Siri Timer Shortcut)"
      to: "src/hooks/useTimers.ts"
      issue: "duration_seconds=0 sentinel not handled — getRemainingSeconds() returns <=0 immediately, timer lands in completedTimers instantly"
      affected_requirements: ["SIRI-02"]
    - from: "supabase/schema.sql"
      to: "supabase/rls-policies.sql"
      issue: "Original 'Allow all' RLS policies may still be active alongside Phase 11's row-count guardrail policies — Postgres OR's permissive policies, potentially bypassing guardrails"
      affected_requirements: []
  flows:
    - flow: "Siri Timer → Wall Display Countdown"
      breaks_at: "useTimers.ts getRemainingSeconds() — duration_seconds=0 means endTime=started_at, timer immediately expired"
      affected_requirements: ["SIRI-02"]
tech_debt:
  - phase: 14-behavior-cleanup
    items:
      - "Pre-existing build error in CountryPanel.tsx (unused unsplashUrl variable) — noted in Phase 14 SUMMARY"
  - phase: 15-siri-voice-integration
    items:
      - "Programmatic shortcut adds one item per invocation (multi-item parsing dropped for reliability)"
      - "Timer shortcut stores raw text as label with duration_seconds=0 — dashboard parsing not implemented"
      - "Manual shortcut guides exist as fallback but differ in features from programmatic shortcuts"
  - phase: documentation
    items:
      - "REQUIREMENTS.md traceability checkboxes all still [ ] Pending — not updated after phase completion"
      - "Phases 12-15 missing VERIFICATION.md files (only Phase 11 was formally verified)"
---

# v1.1 Milestone Audit Report

**Milestone Goal:** Fix broken features, refine layout and UX, add Siri voice integration for groceries and timers.

## Requirements Coverage (3-Source Cross-Reference)

| REQ-ID | Description | VERIFICATION.md | SUMMARY Frontmatter | REQUIREMENTS.md | Final Status |
|--------|-------------|-----------------|---------------------|-----------------|--------------|
| FIX-01 | Horoscopes display daily readings (API Ninjas) | passed (Phase 11) | listed | [ ] | **satisfied** |
| FIX-02 | Calendar events show correct person emoji | missing | listed | [ ] | **satisfied** (integration-verified) |
| CALL-01 | Weather info underneath day header | missing | listed | [ ] | **satisfied** (integration-verified) |
| CALL-02 | Person emoji badge precedes event name | missing | listed | [ ] | **satisfied** (integration-verified) |
| TRNS-01 | BVG departures top 3 only | missing | listed | [ ] | **satisfied** (integration-verified) |
| CTRY-01 | Country of Day landscape photo | missing | listed | [ ] | **satisfied** (integration-verified, requires env var) |
| BEHV-01 | Grocery list no priority interrupt | missing | listed | [ ] | **satisfied** (integration-verified) |
| BEHV-02 | Timer tab removed from mobile nav | missing | listed | [ ] | **satisfied** (integration-verified) |
| SIRI-01 | Siri voice command adds grocery items | missing | listed | [ ] | **satisfied** (integration-verified) |
| SIRI-02 | Siri voice command sets timers | missing | listed | [ ] | **unsatisfied** |

### Orphaned Requirements

None. All 10 v1.1 requirements are mapped to phases and claimed by SUMMARY frontmatter.

## Phase Status

| Phase | VERIFICATION.md | SUMMARY Claims | Integration Check | Status |
|-------|-----------------|----------------|-------------------|--------|
| 11 — Horoscope Fix & RLS Prep | human_needed (6/6) | FIX-01 | PASS | Complete |
| 12 — Calendar Polish | missing | FIX-02, CALL-01, CALL-02 | PASS | Complete (unverified) |
| 13 — Content Enhancements | missing | TRNS-01, CTRY-01 | PASS | Complete (unverified) |
| 14 — Behavior Cleanup | missing | BEHV-01, BEHV-02 | PASS | Complete (unverified) |
| 15 — Siri Voice Integration | missing | SIRI-01, SIRI-02 | SIRI-02 BROKEN | Gap found |

## Integration Check Results

### Passed (8/10 flows)

- **FIX-01**: Horoscope API chain fully wired (client → Worker → API Ninjas → React Query → Panel)
- **FIX-02**: Person emojis correct unicode codepoints in config.ts, used by EventCard.tsx
- **CALL-01**: WeatherBadge in own row between day header and events in DayRow.tsx
- **CALL-02**: Person badges div before summary div in EventCard.tsx flex layout
- **TRNS-01**: `results=3` in bvgTransit.ts, skeleton matches 3 rows
- **CTRY-01**: useCountryImage hook wired to CountryPanel, renders photo when present
- **BEHV-01**: usePriorityInterrupt takes only timer params, no grocery logic
- **BEHV-02**: MobileView type has 3 values, MobileNav renders exactly 3 tabs
- **SIRI-01**: Grocery shortcut inserts valid row via PostgREST with anon key

### Broken (1/10 flows)

- **SIRI-02**: Timer shortcut inserts `duration_seconds=0` as sentinel. Dashboard `useTimers.ts` has no label-parsing logic. `getRemainingSeconds()` returns <=0 immediately. Timer appears as "Done!" alert, not a running countdown.

### Potential Issues

- **RLS Policy Conflict**: Original `"Allow all"` policies in schema.sql may override Phase 11's row-count guardrail policies (Postgres OR's permissive policies)

## Tech Debt Summary

| Phase | Item | Severity |
|-------|------|----------|
| 14 | Pre-existing CountryPanel.tsx build error (unused variable) | Low |
| 15 | Single-item-per-invocation shortcut (multi-item dropped) | Low |
| 15 | Timer duration parsing not implemented in dashboard | **Blocker** |
| docs | REQUIREMENTS.md checkboxes not updated | Low |
| docs | Phases 12-15 missing VERIFICATION.md files | Medium |

---
*Audited: 2026-02-18*
*Auditor: Claude (gsd-audit-milestone)*
